<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Overview - Invisible Cities</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css">
</head>
<style>
  @import url('https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400..800;1,400..800&display=swap');
  body {
    background-color: #f4f3ef;
  }
</style>

<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        const OverviewPage = () => {
            const [cities, setCities] = useState([]);
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                fetch('./cities.json')
                    .then(response => response.json())
                    .then(data => {
                        setCities(data.cities);
                        setLoading(false);
                    })
                    .catch(error => {
                        console.error('Failed to load cities:', error);
                        setLoading(false);
                    });
            }, []);

            // Group cities by category
            const groupedCities = cities.reduce((acc, city) => {
                if (!acc[city.category]) {
                    acc[city.category] = [];
                }
                acc[city.category].push(city);
                return acc;
            }, {});

            // Define category order based on the book structure
            const categoryOrder = [
                "Cities & Memory",
                "Cities & Desire", 
                "Cities & Signs",
                "Thin Cities",
                "Trading Cities",
                "Cities & Eyes",
                "Cities & Names",
                "Cities and the Dead",
                "Cities and the Sky",
                "Continuous Cities",
                "Hidden Cities"
            ];

            if (loading) {
                return (
                    <div className="min-h-screen flex items-center justify-center">
                        <div className="text-gray-500">Loading cities...</div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen">
                    <div className="max-w-6xl mx-auto px-6 py-8">
                        {/* Header */}
                        <div className="flex justify-between items-start mb-12">
                            <div>
                                <h1 className="text-2xl sm:text-3xl font-light text-gray-900 mb-2">overview</h1>
                                <p className="text-gray-600 font-light">invisible cities</p>
                            </div>
                            <a 
                                href="index.html" 
                                className="text-md text-gray-600 hover:text-gray-900 transition-colors pt-1"
                            >
                            ← back to cities
                            </a>
                        </div>

                        {/* Overview content */}
                        <div className="space-y-12">
                            {categoryOrder.map(category => {
                                const categoryCities = groupedCities[category];
                                if (!categoryCities) return null;

                                return (
                                    <div key={category} className="bg-white rounded-lg shadow-sm border border-gray-200 p-8">
                                        <h2 className="text-xl font-light text-gray-900 mb-6 pb-2 border-b border-gray-100">
                                            {category}
                                        </h2>
                                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                            {categoryCities.map((city, index) => (
                                                <div 
                                                    key={city.id}
                                                    className="group cursor-pointer"
                                                    onClick={() => {
                                                        window.location.href = `index.html?city=${city.id}`;
                                                    }}
                                                >
                                                    <div className="p-4 rounded-lg border border-gray-100 hover:border-gray-300 transition-all duration-200 hover:shadow-md bg-gray-50 hover:bg-white">
                                                        <div className="flex items-start justify-between mb-2">
                                                            <h3 className="font-medium text-gray-900 group-hover:text-blue-600 transition-colors">
                                                                {city.name}
                                                            </h3>
                                                            <span className="text-xs text-gray-400 font-mono">
                                                                {String(index + 1).padStart(2, '0')}
                                                            </span>
                                                        </div>
                                                        <div className="flex flex-wrap gap-1 mb-3">
                                                            {city.tags.slice(0, 3).map(tag => (
                                                                <span 
                                                                    key={tag}
                                                                    className="px-2 py-1 text-xs rounded-full bg-gray-200 text-gray-700"
                                                                >
                                                                    {tag}
                                                                </span>
                                                            ))}
                                                            {city.tags.length > 3 && (
                                                                <span className="px-2 py-1 text-xs rounded-full bg-gray-200 text-gray-500">
                                                                    +{city.tags.length - 3}
                                                                </span>
                                                            )}
                                                        </div>
                                                        <p className="text-sm text-gray-600 leading-relaxed line-clamp-3">
                                                            {city.text.substring(0, 120)}...
                                                        </p>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                );
                            })}
                        </div>

                        {/* Footer */}
                        <div className="mt-16 pt-8 border-t border-gray-200">
                            <div className="text-center text-sm text-gray-500">
                                <p>All {cities.length} cities from Italo Calvino's <em>Invisible Cities</em></p>
                                <p className="mt-2">
                                    <a href="about.html" className="text-blue-600 hover:text-blue-800 underline">about</a> • 
                                    <a href="annotation_helper.html" className="text-blue-600 hover:text-blue-800 underline ml-4">annotation tool</a>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<OverviewPage />, document.getElementById('root'));
    </script>
</body>
</html> 